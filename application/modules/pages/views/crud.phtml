<?php
/**
 * @var \Bluz\View\View $this
 */
?>
<?php $uid = uniqid('form_'); ?>

<script>
    function validateForm (data) {
        $('#<?=$uid?>').find('.control-group').removeClass('error');
        $('#<?=$uid?>').find('.help-inline.error').remove();
        if (data.errors) {
            $.each(data.errors, function(field, messages) {
                var $ctrlGroup = $('#<?=$uid?>').find('.control-group:has(#'+field+')').addClass('error');

                messages = messages.join('<br/>');
                var $field = $('#'+field).tooltip({
                    html:true,
                    title:messages,
                    trigger:'manual'
                });
                $field.tooltip('show');
                $field.click(function(){
                    $(this).tooltip('hide');
                });
            });
        }
    }
</script>
<style>
    #<?=$uid?> .modal {
        top: 40%;
        width: 750px;
        margin-left: -345px;
        margin-right: -375px;
    }
    #<?=$uid?> .modal-body {
        max-height: 600px;
    }
    @media (max-width: 767px) {
        #<?=$uid?> .modal.modal {
            top: 10px;
            width: 90%;
            margin: 0
        }
    }
</style>

<form id="<?=$uid?>" action="<?=$this->url('pages', 'crud')?>" class="form-horizontal ajax" method="<?=$method?>">
    <input type="hidden" name="data[id]" value="<?=$row->id?>"/>
    <div class="modal">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h3>Pages</h3>
        </div>
        <div class="modal-body">
            <div class="control-group">
                <label class="control-label" for="title"><?=$this->__('Title')?></label>
                <div class="controls">
                    <input type="text" class="input-xlarge" id="title" name="data[title]" value="<?=($row->title)?>" />
                </div>
            </div>
            <div class="control-group">
                <label class="control-label" for="alias"><?=$this->__('Alias')?></label>
                <div class="controls">
                    <input type="text" class="input-xlarge" id="alias" name="data[alias]" value="<?=($row->alias)?>" />
                </div>
            </div>
            <div class="control-group">
                <label class="control-label" for="keywords"><?=$this->__('Keywords')?></label>
                <div class="controls">
                    <input type="text" class="input-xlarge" id="keywords" name="data[keywords]" value="<?=($row->keywords)?>" />
                </div>
            </div>
            <div class="control-group">
                <label class="control-label" for="description"><?=$this->__('Description')?></label>
                <div class="controls">
                    <input type="text" class="input-xlarge" id="description" name="data[description]" value="<?=($row->description)?>" />
                </div>
            </div>
            <div class="control-group">
                <label for="content"><?=$this->__('Content')?></label>
                <textarea rows="8" cols="26" id="content" class="input-xlarge redactor" name="data[content]"><?=($row->content)?></textarea>
            </div>
        </div>
        <div class="modal-footer">
            <button type="submit" class="btn btn-primary"><?=$this->__('Save')?></button>
            <a href="#" class="btn" data-dismiss="modal"><?=$this->__('Close')?></a>
        </div>
    </div>

</form>

<?=$this->redactor('.redactor', ['autoresize'=>false])?>